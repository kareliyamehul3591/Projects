<%- contentFor('HeaderCss') %>
    <!-- perticular page css -->
    <link href="<%= process.env.AAP_URL %>public/assets/css/bootstrap5.0.2.min.css" rel="stylesheet" type="text/css">

    <!-- Dropzone css -->
    <link href="<%= process.env.AAP_URL %>public/plugins/dropzone/dist/dropzone.css" rel="stylesheet" type="text/css">

    <!--tagsinput css-->
    <link rel="stylesheet" href="<%= process.env.AAP_URL %>public/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css"
        crossorigin="anonymous">

    <style>
        .bootstrap-tagsinput {
            width: 100%;
        }
    </style>
    <%- contentFor('body') %>
        <!-- Start content -->
        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="page-title-box">
                            <h4 class="page-title">My Profile</h4>
                            <!-- <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/">Home</a></li>
                                <li class="breadcrumb-item"><a href="<%= process.env.AAP_URL %>admin/cms">CMS</a></li>
                                <li class="breadcrumb-item active">Create CMS</li>
                            </ol> -->

                        </div>
                    </div>
                </div>
                <!-- end row -->
                <!-- alert_msg -->
                <div id="alert_msg" style="display: none;">
                </div>
                <!-- end row -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="card m-b-20">
                            <div class="card-body">
                                <h4 class="mt-0 header-title">My Profile</h4>


                                <form class="" id="my_profile" method="POST" 
                                    action="<%= process.env.AAP_URL %>admin/myprofile">
                                     <div class="row">
                                        <div class="col-12" style="text-align: center;">
                                            <img class="img-thumbnail rounded-circle" alt="200x200"
                                                src="<%= process.env.AAP_URL %><%=(auth_data.profile_image) ? 'images/'+auth_data.profile_image : 'public/assets/images/users/user-4.jpg' %>"
                                                data-holder-rendered="true" style="width: 12%;">
                                        </div>
                                    </div> 
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>F Name</label>
                                                <input type="text" class="form-control" name="user_name"
                                                    value="<%= auth_data.f_name %>" placeholder="User Name" readonly>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>L Name</label>
                                                <input type="text" class="form-control" name="user_name"
                                                    value="<%= auth_data.l_name %>" placeholder="User Name" readonly>
                                            </div>
                                        </div>                                       
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>User Email</label>
                                                <input type="email" class="form-control" name="user_email"
                                                    value="<%= auth_data.email %>" placeholder="User Email" readonly>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>User Mobile</label>
                                                <div class="row">
                                                    <div class="col-4" style="margin-right: -6%; width: auto">
                                                        
                                                        <select  class="form-control country_code" name="country_code"
                                                        id="country_code" required>
                                                        <option value="<%= auth_data.country_code %>">+<%= auth_data.country_code %></option>
                                                    </select>
                                                    </div>
                                                    <div class="col-8">
                                                        <input type="text" class="form-control" data-parsley-type="digits"
                                                        maxlength="10" pattern="\d{10}" title="Please enter exactly 10 digits" data-parsley-pattern-message="Please Enter Only 10 digits" name="mobile"
                                                        value="<%= auth_data.mobile %>" placeholder="User Mobile" style="width: 108%;">
                                                    </div>
                                                </div>
                                               
                                            </div>
                                        </div>
                                    </div>
                                      
                                      
                                    <div class="row">                                  
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>Joining Date </label>
                                                <input type="text" class="form-control" name="shivyog_share"
                                                    value="<%= new Date(auth_data.created_at).toISOString().substr(0, 10) %>"
                                                    placeholder="Shivyog share" readonly>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>Profile Image</label>
                                                <input type="file" class="filestyle" name="profile_img"
                                                    data-input="false" data-buttonname="btn-secondary">
                                            </div>
                                        </div>
                                    </div> 
                                
                                    <div class="form-group">
                                        <div>
                                            <button type="submit"
                                                class="btn btn-primary waves-effect waves-light">Submit</button>
                                            <a href="<%= process.env.AAP_URL %>admin/user"
                                                class="btn btn-secondary waves-effect m-l-5">Cancel</a>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- end col -->
                </div>
                <!-- end row -->
            </div>
            <!-- container-fluid -->
        </div>
        <!-- content -->

        <%- contentFor('FooterJs') %>
            <!-- filestyle js -->
            <script
                src="<%= process.env.AAP_URL %>public/plugins/bootstrap-filestyle/js/bootstrap-filestyle.min.js"></script>
            <!--tagsinput js -->
            <script src="<%= process.env.AAP_URL %>public/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"
                crossorigin="anonymous"></script>
            <!-- Parsley js -->
            <script src="<%= process.env.AAP_URL %>public/plugins/parsleyjs/parsley.min.js"></script>
            <!--ajax form-->
            <script src="<%= process.env.AAP_URL %>public/plugins/ajax-form/jquery.form.min.js"></script>
            <!--Wysiwig js-->
            <script src="<%= process.env.AAP_URL %>public/plugins/tinymce/tinymce.min.js"></script>
            <script src="<%= process.env.AAP_URL %>public/plugins/parsleyjs/jquery.validate.min.js"></script>
            <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.13.1/additional-methods.js"></script>
            <script>
                $(document).ready(function () {
                    $('form').parsley();
                });
                country_codelist();
                $(document).ready(function () {
                    setTimeout(function () {
                        $('#alert_msg').hide();
                    }, 5000);
                });
                $.validator.addMethod('filesize', function (value, element, param) {
                    return this.optional(element) || (element.files[0].size <= param)
                }, 'File size must be less than 2MB');
                $('#my_profile').validate({ 
                            rules: {
                                profile_img: {
                                    required: true,
                                    extension: "jpg,jpeg",
                                    filesize : 2 * 1024 * 1024,
                                }
                            },
                            messages: {
                                profile_img: {
                                    required: 'File is too Large'
                                }
                            }
                        });
                $(document).ready(function () {
                    $('#my_profile').ajaxForm({
                        beforeSubmit: function () { },
                        success: function (data) {
                            alert(data.message);
                            if (data.success == 1) {
                                /* alert(data); */
                                 alert_msg("success", data.message); 
                                location.reload();
                            } else {
                                alert_msg("error", data.message);
                            }
                        },
                        complete: function (xhr) {
                        }
                    });
                });


                
                 function country_codelist() {
                    $.get('<%= process.env.AAP_URL %>admin/country_mobile_code',
                    {},
                    function(data){
                        if(data.success == 1)
                        {                          
                          
                            var html = '<option value="">+</option>';
                           $.each(data.data, function (index, value) {
                                html += '<option value="'+value.phonecode+'">+'+value.phonecode+'</option>';
                            });
                             $(".country_code").append(html);
                          }
                    },
                    'json');
                }
 

                function alert_msg(status, msg) {
                    //(success,danger)
                    if (status != "success") {
                        status = "danger";
                    }
                    var html = '';
                    html += '<div class="alert alert-' + status + ' alert-dismissible fade show" id="alert_success" role="alert">';
                    html += '<button type="button" class="close" data-dismiss="alert" aria-label="Close">';
                    html += '<span aria-hidden="true">&times;</span>';
                    html += '</button>';
                    html += '<div class="msg">' + msg + '</div>';
                    html += '</div>';
                    $("#alert_msg").html(html);
                    $("#alert_msg").show();
                    setTimeout(function () {
                        $('#alert_msg').hide();
                    }, 5000);
                }
            </script>